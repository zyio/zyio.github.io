<!DOCTYPE html>
<html lang="en-gb">
    <head>
         
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Patching the magento shoplift vulnerability</title>
        
        <style>

    html body {
        font-family: 'Raleway', sans-serif;
        background-color: white;
    }

    :root {
        --accent: green;
        --border-width:  5px ;
    }

</style>


<link rel="stylesheet" href="http://zy.io/css/main.css">





<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">


 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-dark.min.css"> 


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
 


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ruby.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bash.min.js"></script> 

    <script>hljs.initHighlightingOnLoad();</script>







<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<script>$(document).on('click', function() { $('.collapse').collapse('hide'); })</script>
 <meta name="generator" content="Hugo 0.41" />
        

        
    </head>

    
    
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    

    <body>
         
        <nav class="navbar navbar-default navbar-fixed-top">

            <div class="container">

                <div class="navbar-header">

                    <a class="navbar-brand visible-xs" href="#">Patching the magento shoplift vulnerability</a>

                    <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                </div>

                <div class="collapse navbar-collapse">

                    
                        <ul class="nav navbar-nav">
                            
                                <li><a href="/">Home</a></li>
                            
                                <li><a href="/blog/">Posts</a></li>
                            
                                <li><a href="/about/">About</a></li>
                            
                        </ul>
                    

                    
                        <ul class="nav navbar-nav navbar-right">
                            
                                <li class="navbar-icon"><a href="mailto:sam@zy.io"><i class="fa fa-envelope-o"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.instagram.com/sam.norbury/"><i class="fa fa-instagram"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://github.com/zyio/"><i class="fa fa-github"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://keybase.io/zyio"><i class="fa fa-key"></i></a></li>
                            
                                <li class="navbar-icon"><a href="https://www.linkedin.com/in/sam-norbury/"><i class="fa fa-linkedin"></i></a></li>
                            
                        </ul>
                    

                </div>

            </div>

        </nav>


<main>

    <div class="item">

    
    
    

    
    

    <h4><a href="/blog/2015-04-25-patching-the-magento-shoplift-vulnerability/">Patching the magento shoplift vulnerability</a></h4>
    <h5>April 25, 2015</h5>
    

</div>


    <br> <div class="text-justify"><div class="document">


<p>A vulnerability coming out for a major CMS is always a big deal. Working for a fairly big hosting company however makes it about 9000 times worse. It must be a scary moment when you log into the admin area of your website and get a big pop up letting you know you need to patch against some critical issues that put you and all your customers at risk.</p>
<p>Shame it took Magento 2 months to do that.</p>
<p>The Magento 'shoplift' vulnerability has been covered extensively elsewhere, so there's not much point in further rambling on about it here. Suffice to say, I think there's been a fairly terrible response from Magento. Shipping unpatched versions of your code when you're got a share of the market this size sounds practically criminal. Putting the necessary patches behind a login wall is just an extra kick in the ribs.</p>
<p>I cobbled the following script together mainly for use in house, as some people run 50+ magento sites on one server and going through manaually selecting, downloading and applying patches to them wasn't something I was in a rush to do.</p>
<p>There are a few similar scripts out there already, but they all seemed to have limitations in some way, as they only worked on one particular kind of environment. Maybe they assumed you kept all your websites in <tt class="docutils literal"><span class="pre">/home/www/*/htdocs</span></tt>, that all your servers were on Ubuntu (God forbid) or that all your magento versions were identical. I didn't really have that luxury, so I wrote this with the aim of hopefully ferreting out all the magento installs on a server and applying patches to any version, regardles of OS. I'm not meaning to say that it's perfect, far from it, but it seems to get the job done.</p>
<p>You can find it on my github here:</p>
<p><a class="reference external" href="https://github.com/zyio/magento-shoplift-autopatcher">https://github.com/zyio/magento-shoplift-autopatcher</a></p>
<p>As the readme says, the general idea is to run <tt class="docutils literal">main.sh</tt> as root, like so:</p>
<p><tt class="docutils literal">bash main.sh</tt></p>
<p>For anyone who trusts me for some reason, or just likes executing arbitrary bash straight from the internet, you can run it like this:</p>
<p><tt class="docutils literal">curl <span class="pre">-s</span> <span class="pre">https://raw.githubusercontent.com/zyio/magento-shoplift-autopatcher/master/main.sh|bash</span></tt></p>
<p>We'll save that argument for another day.</p>
<p>It's fairly well commented, so hopefully it's relatively clear what's going on.</p>
<p>As ever, any questions/comments, please drop me a mail. Details should be on the <a class="reference external" href="http://zy.io/about.html">about page</a></p>
</div></div>

    
    

    

    

</main>

        <footer>

            <p class="copyright text-muted">&copy; All rights reserved.</p>

        </footer>
       
    </body>

</html>

